import{b as f,r as d,j as e,V as l,z as T,h as w,u,A as P,B as L,C as R,D as _}from"./index-BMz7zIRN.js";import{I as O}from"./InlineSodomallLoader-CN_E-RXV.js";import{G as N,U as $}from"./user-plus-DMCucGJt.js";import{I as y}from"./info-DxE8bBlt.js";import{c as v}from"./createLucideIcon-Df3tO_ja.js";import{S as k}from"./shield-DCKi_qae.js";import{T as G}from"./trending-up-BeywEaFl.js";import{C as b}from"./chevron-right-BbSiuQEu.js";import{A,m as j}from"./proxy-CA4nXXUX.js";import{X as U}from"./x-BfIBbJBP.js";import{M as g}from"./index-CDTLh11W.js";import{S as C}from"./shield-x-DqlWjWof.js";import{S as M,a as z,G as S,C as I}from"./sparkles-CiURa8Z7.js";import{C as F}from"./chart-no-axes-column-CffmgICP.js";import{C as E}from"./calendar-B4F1rzMj.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],B=v("copy",V);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],W=v("log-out",H),X=()=>{const{user:s}=f(),[a,t]=d.useState(""),[i,r]=d.useState(!1),o=async()=>{if(!s){l.error("ë¡œê·¸ì¸ ì •ë³´ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");return}if(!a.trim()){l.error("ì´ˆëŒ€ ì½”ë“œë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”.");return}r(!0);const n=T(a.trim().toUpperCase());l.promise(n,{loading:"ì½”ë“œë¥¼ í™•ì¸í•˜ëŠ” ì¤‘...",success:c=>String(c),error:c=>c.message||"ì½”ë“œ ì ìš©ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”."});try{await n}catch(c){console.error("Referral code submission failed:",c)}finally{r(!1)}};return e.jsxs("div",{className:"referral-input-card","data-tutorial-id":"mypage-referral-input",children:[e.jsxs("div",{className:"referral-input-header",children:[e.jsx(N,{size:24}),e.jsx("h4",{children:"ì¹œêµ¬ ì´ˆëŒ€ ì½”ë“œ ìž…ë ¥"})]}),e.jsxs("p",{className:"referral-input-guide",children:[e.jsx(y,{size:14}),e.jsxs("span",{className:"guide-text",children:["ì´ˆëŒ€ ì½”ë“œë¥¼ ìž…ë ¥í•˜ê³  ì¦‰ì‹œ ",e.jsx("strong",{children:"30í¬ì¸íŠ¸"}),"ë¥¼ ë°›ìœ¼ì„¸ìš”! (ìµœì´ˆ 1íšŒ)"]})]}),e.jsxs("div",{className:"referral-input-form",children:[e.jsx("input",{type:"text",value:a,onChange:n=>t(n.target.value.toUpperCase()),placeholder:"ì¹œêµ¬ì—ê²Œ ë°›ì€ ì´ˆëŒ€ ì½”ë“œ",disabled:i}),e.jsx("button",{onClick:o,className:"common-button button-primary",disabled:i,children:i?"í™•ì¸ ì¤‘...":"í¬ì¸íŠ¸ ë°›ê¸°"})]})]})},K=s=>{switch(s){case"ê³µêµ¬ì˜ ì‹ ":return{tierName:"ê³µêµ¬ì˜ ì‹ ",icon:e.jsx(I,{size:24})};case"ê³µêµ¬ì™•":return{tierName:"ê³µêµ¬ì™•",icon:e.jsx(S,{size:24})};case"ê³µêµ¬ìš”ì •":return{tierName:"ê³µêµ¬ìš”ì •",icon:e.jsx(z,{size:24})};case"ê³µêµ¬ìƒˆì‹¹":return{tierName:"ê³µêµ¬ìƒˆì‹¹",icon:e.jsx("i",{className:"seedling-icon-mypage",children:"ðŸŒ±"})};case"ì£¼ì˜ ìš”ë§":return{tierName:"ì£¼ì˜ ìš”ë§",icon:e.jsx(M,{size:24})};case"ì°¸ì—¬ ì œí•œ":return{tierName:"ì°¸ì—¬ ì œí•œ",icon:e.jsx(C,{size:24})};default:return{tierName:"ê³µêµ¬ìƒˆì‹¹",icon:e.jsx("i",{className:"seedling-icon-mypage",children:"ðŸŒ±"})}}},q=(s,a,t)=>{const i=a+t,r=i>0?Math.round(a/i*100):0;if(s==="ì°¸ì—¬ ì œí•œ")return{currentRate:r,progressMessage:"ëˆ„ì  ë…¸ì‡¼ 3íšŒ ì´ìƒìœ¼ë¡œ ì°¸ì—¬ê°€ ì œí•œë˜ì—ˆìŠµë‹ˆë‹¤."};if(i===0)return{currentRate:0,progressMessage:"ì²« í”½ì—… ì™„ë£Œ ì‹œ ë“±ê¸‰ì´ ì‚°ì •ë©ë‹ˆë‹¤."};switch(s){case"ì£¼ì˜ ìš”ë§":const o=Math.max(0,Math.ceil(t*7/3-a));return{currentRate:r,progressMessage:`'ê³µêµ¬ìƒˆì‹¹'ìœ¼ë¡œ ë³µê·€í•˜ë ¤ë©´ ì•½ ${o}íšŒì˜ ì¶”ê°€ í”½ì—…ì´ í•„ìš”í•´ìš”.`};case"ê³µêµ¬ìƒˆì‹¹":const n=Math.max(0,30-a);return{currentRate:r,progressMessage:`ë‹¤ìŒ ë“±ê¸‰ 'ê³µêµ¬ìš”ì •'ê¹Œì§€ í”½ì—… ${n}íšŒ ë‚¨ì•˜ìŠµë‹ˆë‹¤. (í”½ì—… 30íšŒ & í”½ì—…ë¥  90%â†‘)`};case"ê³µêµ¬ìš”ì •":const c=Math.max(0,100-a);return{currentRate:r,progressMessage:`ë‹¤ìŒ ë“±ê¸‰ 'ê³µêµ¬ì™•'ê¹Œì§€ í”½ì—… ${c}íšŒ ë‚¨ì•˜ìŠµë‹ˆë‹¤. (í”½ì—… 100íšŒ & í”½ì—…ë¥  95%â†‘)`};case"ê³µêµ¬ì™•":const m=Math.max(0,250-a);return{currentRate:r,progressMessage:`ë‹¤ìŒ ë“±ê¸‰ 'ê³µêµ¬ì˜ ì‹ 'ê¹Œì§€ í”½ì—… ${m}íšŒ ë‚¨ì•˜ìŠµë‹ˆë‹¤. (í”½ì—… 250íšŒ & í”½ì—…ë¥  98%â†‘)`};case"ê³µêµ¬ì˜ ì‹ ":return{currentRate:r,progressMessage:"ìµœê³  ë“±ê¸‰ 'ê³µêµ¬ì˜ ì‹ 'ìž…ë‹ˆë‹¤! ì–¸ì œë‚˜ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤. ðŸ’–"};default:return{currentRate:r,progressMessage:"ì„±ì‹¤í•œ í”½ì—…ìœ¼ë¡œ ë“±ê¸‰ì„ ì˜¬ë ¤ë³´ì„¸ìš”!"}}},p=s=>{switch(s){case"ê³µêµ¬ì˜ ì‹ ":return"tier-god";case"ê³µêµ¬ì™•":return"tier-king";case"ê³µêµ¬ìš”ì •":return"tier-fairy";case"ê³µêµ¬ìƒˆì‹¹":return"tier-sprout";case"ì£¼ì˜ ìš”ë§":return"tier-warning";case"ì°¸ì—¬ ì œí•œ":return"tier-restricted";default:return"tier-default"}},J=({percentage:s,tier:a})=>{const[t,i]=d.useState(0),r=52,o=2*Math.PI*r,n=p(a);return d.useEffect(()=>{const c=(100-s)/100*o;i(c)},[s,o]),e.jsxs("div",{className:"progress-ring-wrapper",children:[e.jsxs("svg",{className:"progress-ring",width:"120",height:"120",children:[e.jsx("circle",{className:"progress-ring__circle-bg",strokeWidth:"8",fill:"transparent",r,cx:"60",cy:"60"}),e.jsx("circle",{className:`progress-ring__circle ${n}`,strokeWidth:"8",fill:"transparent",r,cx:"60",cy:"60",style:{strokeDasharray:o,strokeDashoffset:t}})]}),e.jsxs("div",{className:"progress-ring__text",children:[e.jsxs("span",{className:"percentage",children:[s,"%"]}),e.jsx("span",{className:"label",children:"í”½ì—…ë¥ "})]})]})},Q=[{tier:"ê³µêµ¬ì˜ ì‹ ",icon:e.jsx(I,{size:24}),criteria:"í”½ì—…ë¥  98% ì´ìƒ & ëˆ„ì  í”½ì—… 250íšŒ ì´ìƒ"},{tier:"ê³µêµ¬ì™•",icon:e.jsx(S,{size:24}),criteria:"í”½ì—…ë¥  95% ì´ìƒ & ëˆ„ì  í”½ì—… 100íšŒ ì´ìƒ"},{tier:"ê³µêµ¬ìš”ì •",icon:e.jsx(z,{size:24}),criteria:"í”½ì—…ë¥  90% ì´ìƒ & ëˆ„ì  í”½ì—… 30íšŒ ì´ìƒ"},{tier:"ê³µêµ¬ìƒˆì‹¹",icon:e.jsx("i",{className:"seedling-icon-mypage",children:"ðŸŒ±"}),criteria:"í”½ì—…ë¥  70% ì´ìƒ (ì²« í”½ì—… ì™„ë£Œ ì‹œ ë‹¬ì„±)"},{tier:"ì£¼ì˜ ìš”ë§",icon:e.jsx(M,{size:24}),criteria:"í”½ì—…ë¥  70% ë¯¸ë§Œ"},{tier:"ì°¸ì—¬ ì œí•œ",icon:e.jsx(C,{size:24}),criteria:"ëˆ„ì  ë…¸ì‡¼ 3íšŒ ì´ìƒ ì‹œ ì¦‰ì‹œ ì ìš©"}],Y=({isOpen:s,onClose:a})=>e.jsx(A,{children:s&&e.jsx(j.div,{className:"modal-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:a,children:e.jsxs(j.div,{className:"modal-content tier-guide-modal",initial:{y:50,opacity:0},animate:{y:0,opacity:1},exit:{y:50,opacity:0},transition:{type:"spring",stiffness:300,damping:30},onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h4",{children:"ðŸ‘‘ ì‹ ë¢° ë“±ê¸‰ ì•ˆë‚´"}),e.jsx("button",{onClick:a,className:"modal-close-button",children:e.jsx(U,{size:24})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{className:"guide-intro",children:e.jsx(g,{children:"ì†Œë„ëª°ì˜ ë“±ê¸‰ì€ í¬ì¸íŠ¸ì™€ ë¬´ê´€í•˜ë©°, ì˜¤ì§ **'í”½ì—… ì•½ì† ì´í–‰'**ìœ¼ë¡œë§Œ ê²°ì •ë©ë‹ˆë‹¤.\n\n**'ì£¼ë¬¸ ê±´'**ì„ ê¸°ì¤€ìœ¼ë¡œ, 1ê±´ì˜ ì£¼ë¬¸ì„ ì •ìƒ í”½ì—…í•˜ë©´ `í”½ì—… 1íšŒ`ê°€ ê¸°ë¡ë©ë‹ˆë‹¤. (ì£¼ë¬¸í•œ ìƒí’ˆì˜ ê°œìˆ˜ì™€ëŠ” ë¬´ê´€í•©ë‹ˆë‹¤)"})}),e.jsx("div",{className:"tier-details-list",children:Q.map(r=>e.jsxs("div",{className:`tier-detail-item ${p(r.tier)}`,children:[e.jsxs("div",{className:"tier-detail-icon-name",children:[e.jsx("div",{className:"tier-item-icon",children:r.icon}),e.jsx("div",{className:"tier-item-name",children:r.tier})]}),e.jsx("div",{className:"tier-detail-criteria",children:r.criteria})]},r.tier))}),e.jsx("div",{className:"guide-outro",children:e.jsx(g,{children:"ë†’ì€ ì‹ ë¢° ë“±ê¸‰ì„ ê°€ì§„ ê³ ê°ë‹˜ë“¤ê»˜ëŠ” **'ì„ ì£¼ë¬¸'** ì´ë‚˜ **'ì‹œí¬ë¦¿ ìƒí’ˆ'** ì°¸ì—¬ ê¸°íšŒì²˜ëŸ¼ íŠ¹ë³„í•œ í˜œíƒì´ ê°€ìž¥ ë¨¼ì € ì£¼ì–´ì§‘ë‹ˆë‹¤! âœ¨"})})]})]})})}),Z=({userDocument:s,onTierClick:a})=>{const t=u(),i=d.useMemo(()=>K(s?.loyaltyTier||"ê³µêµ¬ìƒˆì‹¹"),[s?.loyaltyTier]),r=d.useMemo(()=>q(s?.loyaltyTier||"ê³µêµ¬ìƒˆì‹¹",s?.pickupCount||0,s?.noShowCount||0),[s?.loyaltyTier,s?.pickupCount,s?.noShowCount]),o=p(i.tierName),n=s.role==="admin"||s.role==="master",c=n?`role-${s.role}`:o;return e.jsxs("div",{className:`unified-profile-card-v2 ${c}`,children:[e.jsx("div",{className:"card-v2-background"}),e.jsxs("div",{className:"card-v2-content",children:[e.jsxs("div",{className:"profile-tier-section-v2",onClick:a,"data-tutorial-id":"mypage-profile-card",children:[e.jsxs("div",{className:"tier-display",children:[e.jsxs("div",{className:"tier-icon-name",children:[n?e.jsx(k,{size:24}):i.icon,e.jsx("span",{className:"tier-name",children:n?s.role?.toUpperCase():i.tierName})]}),e.jsxs("span",{className:"display-name",children:[s.displayName||"ê³ ê°","ë‹˜",s.nickname&&e.jsxs("span",{className:"nickname-display",children:[" (",s.nickname,")"]})]}),e.jsx("p",{className:"progress-message",children:n?"ëª¨ë“  ê¶Œí•œì„ ê°€ì§€ê³  ìžˆìŠµë‹ˆë‹¤.":r.progressMessage})]}),!n&&e.jsx(J,{percentage:r.currentRate,tier:i.tierName})]}),e.jsxs("div",{className:"profile-points-section-v2",onClick:()=>t("/mypage/points"),children:[e.jsxs("div",{className:"points-label",children:[e.jsx(G,{size:18}),e.jsx("span",{children:"í™œë™ í¬ì¸íŠ¸"})]}),e.jsxs("div",{className:"points-value",children:[e.jsxs("span",{children:[(s?.points||0).toLocaleString()," P"]}),e.jsx(b,{size:16,className:"arrow-icon"})]})]})]})]})},D=({userDocument:s})=>{const[a,t]=d.useState(""),[i,r]=d.useState(!1),o=async()=>{if(!a.trim()){l.error("ë‹‰ë„¤ìž„ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”.",{duration:3e3});return}r(!0);const n=L(R,"users",s.uid),c=_(n,{nickname:a.trim(),nicknameChanged:!0});l.promise(c,{loading:"ë‹‰ë„¤ìž„ì„ ì €ìž¥í•˜ëŠ” ì¤‘...",success:"ë‹‰ë„¤ìž„ì´ ì„±ê³µì ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!",error:"ë‹‰ë„¤ìž„ ì €ìž¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."},{success:{duration:3e3},error:{duration:3e3}});try{await c}catch{}finally{r(!1)}};return s.nicknameChanged||s.nickname?null:e.jsxs("div",{className:"nickname-setup-card","data-tutorial-id":"mypage-nickname-setup",children:[e.jsxs("div",{className:"nickname-setup-header",children:[e.jsx($,{size:24}),e.jsx("h4",{children:"ë‹‰ë„¤ìž„ ì„¤ì • (ìµœì´ˆ 1íšŒ)"})]}),e.jsxs("p",{className:"nickname-setup-guide",children:[e.jsx(y,{size:14}),"ì¹´ì¹´ì˜¤í†¡ ì˜¤í”ˆì±„íŒ…ë°©ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë‹‰ë„¤ìž„ìœ¼ë¡œ ì„¤ì •í•˜ì‹œë©´ ì†Œí†µì´ ì›í™œí•©ë‹ˆë‹¤."]}),e.jsxs("div",{className:"nickname-setup-form",children:[e.jsx("input",{type:"text",value:a,onChange:n=>t(n.target.value),placeholder:"ì‚¬ìš©í•˜ì‹¤ ë‹‰ë„¤ìž„ì„ ìž…ë ¥í•˜ì„¸ìš”",disabled:i}),e.jsx("button",{onClick:o,className:"common-button button-primary",disabled:i,children:i?"ì €ìž¥ ì¤‘...":"ì €ìž¥"})]})]})},ee=({referralCode:s})=>{const a=()=>{s&&navigator.clipboard.writeText(s).then(()=>l.success("ì´ˆëŒ€ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!",{duration:3e3})).catch(t=>{l.error("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",{duration:3e3}),console.error("í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:",t)})};return s?e.jsxs("div",{className:"referral-card","data-tutorial-id":"mypage-referral-code",children:[e.jsxs("div",{className:"referral-info",children:[e.jsx("div",{className:"referral-icon",children:e.jsx(N,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{children:"ì¹œêµ¬ ì´ˆëŒ€í•˜ê³  í¬ì¸íŠ¸ ë°›ê¸°"}),e.jsxs("p",{children:["ì¹œêµ¬ê°€ ë‚´ ì½”ë“œë¥¼ ìž…ë ¥í•˜ê³  ì²« í”½ì—…ì„ ì™„ë£Œí•˜ë©´ ",e.jsx("strong",{children:"30P"}),"ê°€ ì ë¦½ë©ë‹ˆë‹¤."]})]})]}),e.jsxs("div",{className:"referral-action",children:[e.jsx("span",{className:"referral-code",children:s}),e.jsxs("button",{onClick:a,className:"copy-button",children:[e.jsx(B,{size:16}),"ë³µì‚¬"]})]})]}):null},se=()=>{const s=u(),a=[{icon:e.jsx(F,{size:22,className:"icon-history"}),label:"ì£¼ë¬¸/ëŒ€ê¸° ë‚´ì—­",path:"/mypage/history"},{icon:e.jsx(E,{size:22,className:"icon-calendar"}),label:"í”½ì—… ë‹¬ë ¥",path:"/mypage/orders"},{icon:e.jsx(k,{size:22,className:"icon-encore"}),label:"ë§ˆê° ìƒí’ˆ (ì•µì½œ)",path:"/encore"}];return e.jsx("nav",{className:"mypage-menu-list","data-tutorial-id":"mypage-menu-list",children:a.map(t=>e.jsxs("div",{className:"menu-list-item",onClick:()=>s(t.path),children:[e.jsxs("div",{className:"menu-item-content",children:[t.icon,e.jsx("span",{children:t.label})]}),e.jsx(b,{size:20,className:"menu-item-arrow"})]},t.label))})},ge=()=>{const{user:s,userDocument:a,logout:t}=f(),{runPageTourIfFirstTime:i}=w(),r=u(),[o,n]=d.useState(!1);d.useEffect(()=>{a&&i("hasSeenMyPage",P)},[a,i]);const c=d.useCallback(()=>{l(x=>e.jsxs("div",{className:"confirmation-toast",children:[e.jsx("h4",{children:"ë¡œê·¸ì•„ì›ƒ"}),e.jsx("p",{children:"ì •ë§ ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"}),e.jsxs("div",{className:"toast-buttons",children:[e.jsx("button",{className:"common-button button-secondary button-medium",onClick:()=>l.dismiss(x.id),children:"ì·¨ì†Œ"}),e.jsx("button",{className:"common-button button-danger button-medium",onClick:async()=>{l.dismiss(x.id),await t(),r("/login"),l.success("ì„±ê³µì ìœ¼ë¡œ ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.",{duration:3e3})},children:"ë¡œê·¸ì•„ì›ƒ"})]})]}),{duration:1/0})},[t,r]);if(!s||!a)return e.jsx("div",{className:"mypage-container",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:e.jsx(O,{})});const m=a.referredBy===null,h=!a.nicknameChanged&&!a.nickname;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"customer-page-container mypage-container",children:[e.jsx(Z,{userDocument:a,onTierClick:()=>n(!0)}),e.jsxs("div",{className:"mypage-menu-list-wrapper",children:[e.jsx(ee,{referralCode:a?.referralCode}),e.jsx(se,{}),(h||m)&&e.jsxs("div",{className:"mypage-task-section",children:[h&&e.jsx(D,{userDocument:a}),m&&e.jsx(X,{})]})]}),e.jsx("div",{className:"logout-section",children:e.jsxs("button",{onClick:c,className:"logout-button",children:[e.jsx(W,{size:16}),"ë¡œê·¸ì•„ì›ƒ"]})})]}),e.jsx(Y,{isOpen:o,onClose:()=>n(!1)})]})};export{ge as default};
