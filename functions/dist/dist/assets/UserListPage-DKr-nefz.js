import{r as l,a1 as U,a2 as D,C as $,af as R,T as L,j as e,S as E,L as V}from"./index-BMz7zIRN.js";import{u as F}from"./useDocumentTitle-BBAuQihd.js";import{P as G,D as q}from"./PointManagementModal-DQ5B4Jdr.js";import{f as B}from"./formatUtils-C7pUNVKC.js";import{S as K}from"./search-C7k3Fw0J.js";import{A as x}from"./arrow-up-down-9iQe4W9e.js";import{S as Q}from"./shield-x-DqlWjWof.js";import{S as X,a as H,G as J,C as W}from"./sparkles-CiURa8Z7.js";import{C as Y}from"./chevrons-left-DkUsVS3s.js";import{C as Z}from"./chevrons-right-B6gfhwfl.js";import"./createLucideIcon-Df3tO_ja.js";import"./x-BfIBbJBP.js";import"./loader-circle-B7eOStzy.js";const _={"ê³µêµ¬ì˜ ì‹ ":{icon:e.jsx(W,{size:16}),color:"var(--loyalty-god)"},ê³µêµ¬ì™•:{icon:e.jsx(J,{size:16}),color:"var(--loyalty-king)"},ê³µêµ¬ìš”ì •:{icon:e.jsx(H,{size:16}),color:"var(--loyalty-fairy)"},ê³µêµ¬ìƒˆì‹¹:{icon:e.jsx("i",{className:"seedling-icon",children:"ðŸŒ±"}),color:"var(--loyalty-sprout)"},"ì£¼ì˜ ìš”ë§":{icon:e.jsx(X,{size:16}),color:"var(--loyalty-warning)"},"ì°¸ì—¬ ì œí•œ":{icon:e.jsx(Q,{size:16}),color:"var(--loyalty-restricted)"}},ee={master:{label:"ë§ˆìŠ¤í„°",className:"role-master"},admin:{label:"ê´€ë¦¬ìž",className:"role-admin"},customer:{label:"ê³ ê°",className:"role-customer"}},se=({currentPage:r,totalPages:j,onPageChange:u,itemsPerPage:b,onItemsPerPageChange:c,totalItems:y})=>y===0?null:e.jsxs("div",{className:"pagination-container",children:[e.jsx("div",{className:"pagination-left",children:e.jsxs("div",{className:"items-per-page-selector",children:[e.jsx("label",{htmlFor:"itemsPerPage",children:"í‘œì‹œ ê°œìˆ˜:"}),e.jsxs("select",{id:"itemsPerPage",value:b,onChange:c,children:[e.jsx("option",{value:20,children:"20ê°œ"}),e.jsx("option",{value:50,children:"50ê°œ"}),e.jsx("option",{value:100,children:"100ê°œ"})]})]})}),e.jsxs("div",{className:"pagination-center",children:[e.jsx("button",{onClick:()=>u(1),disabled:r===1,title:"ì²« íŽ˜ì´ì§€",children:e.jsx(Y,{size:16})}),e.jsx("button",{onClick:()=>u(r-1),disabled:r===1,children:"ì´ì „"}),e.jsxs("span",{className:"page-info",children:[r," / ",j]}),e.jsx("button",{onClick:()=>u(r+1),disabled:r===j,children:"ë‹¤ìŒ"}),e.jsx("button",{onClick:()=>u(j),disabled:r===j,title:"ë§ˆì§€ë§‰ íŽ˜ì´ì§€",children:e.jsx(Z,{size:16})})]}),e.jsx("div",{className:"pagination-right",children:e.jsxs("span",{className:"total-items-display",children:["ì´ ",y,"ëª…"]})})]}),ue=()=>{F("ì „ì²´ ê³ ê° ê´€ë¦¬");const[r,j]=l.useState([]),[u,b]=l.useState(!0),[c,y]=l.useState(""),[v,I]=l.useState({key:"createdAt",direction:"desc"}),[T,k]=l.useState(!1),[M,O]=l.useState(null),[S,w]=l.useState(1),[p,A]=l.useState(20);l.useEffect(()=>{b(!0);const s=U(D($,"users")),a=R(s,n=>{const t=n.docs.map(h=>({...h.data(),uid:h.id}));j(t),b(!1)},n=>{console.error("ì‚¬ìš©ìž ëª©ë¡ ë¡œë”© ì˜¤ë¥˜:",n),b(!1)});return()=>a()},[]),l.useEffect(()=>{w(1)},[c,p,v]);const m=s=>{let a="desc";v.key===s&&v.direction==="desc"&&(a="asc"),I({key:s,direction:a})},C=l.useMemo(()=>{let s=r.filter(a=>(a.displayName||"").toLowerCase().includes(c.toLowerCase())||(a.nickname||"").toLowerCase().includes(c.toLowerCase())||(a.email||"").toLowerCase().includes(c.toLowerCase())||(a.phone||"").includes(c));return s.sort((a,n)=>{const{key:t,direction:h}=v,o=h==="asc"?1:-1;if(t==="points"||t==="noShowCount"){const i=Number(a[t]||0),d=Number(n[t]||0);return(i-d)*o}if(t==="loyaltyTier"){const i=["ê³µêµ¬ì˜ ì‹ ","ê³µêµ¬ì™•","ê³µêµ¬ìš”ì •","ê³µêµ¬ìƒˆì‹¹","ì£¼ì˜ ìš”ë§","ì°¸ì—¬ ì œí•œ"],d=i.indexOf(a.loyaltyTier||"ê³µêµ¬ìƒˆì‹¹"),g=i.indexOf(n.loyaltyTier||"ê³µêµ¬ìƒˆì‹¹");return(d-g)*o}if(t==="role"){const i=["master","admin","customer"],d=i.indexOf(a.role||"customer"),g=i.indexOf(n.role||"customer");return(d-g)*o}if(t==="isSuspended"){const i=a.isSuspended?1:0,d=n.isSuspended?1:0;return(i-d)*o}if(t==="nickname"){const i=a.nickname||"",d=n.nickname||"";return i.localeCompare(d)*o}const N=a[t],f=n[t];return N instanceof L&&f instanceof L?(N.toMillis()-f.toMillis())*o:N==null?1*o:f==null?-1*o:typeof N=="number"&&typeof f=="number"?(N-f)*o:String(N).localeCompare(String(f))*o}),s},[c,r,v]),z=l.useMemo(()=>{const s=(S-1)*p;return C.slice(s,s+p)},[C,S,p]),P=s=>{O(s),k(!0)};return u?e.jsx(E,{message:"ê³ ê° ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."}):e.jsxs(e.Fragment,{children:[e.jsx(G,{isOpen:T,onClose:()=>k(!1),user:M}),e.jsxs("div",{className:"admin-page-container full-width-container",children:[e.jsx("header",{className:"admin-page-header",children:e.jsx("h1",{className:"admin-page-title",children:"ì „ì²´ ê³ ê° ê´€ë¦¬"})}),e.jsx("div",{className:"list-controls-v3",children:e.jsxs("div",{className:"search-bar-wrapper-v2",children:[e.jsx(K,{size:20,className:"search-icon-v2"}),e.jsx("input",{type:"text",placeholder:"ê³ ê°ëª…, ë‹‰ë„¤ìž„, ì´ë©”ì¼, ì „í™”ë²ˆí˜¸ë¡œ ê²€ìƒ‰...",value:c,onChange:s=>y(s.target.value),className:"search-input-v2"})]})}),e.jsx("div",{className:"admin-table-container",children:e.jsxs("table",{className:"admin-table excel-style responsive-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"col-tier",onClick:()=>m("loyaltyTier"),children:e.jsxs("div",{className:"sortable-header",children:["ë“±ê¸‰ ",e.jsx(x,{size:12})]})}),e.jsx("th",{className:"col-name-nickname",onClick:()=>m("displayName"),children:e.jsxs("div",{className:"sortable-header",children:["ì´ë¦„(ë‹‰ë„¤ìž„) ",e.jsx(x,{size:12})]})}),e.jsx("th",{className:"col-phone",children:"ì „í™”ë²ˆí˜¸"}),e.jsx("th",{className:"col-email",children:"ì´ë©”ì¼"}),e.jsx("th",{className:"col-role",onClick:()=>m("role"),children:e.jsxs("div",{className:"sortable-header",children:["ê¶Œí•œ ",e.jsx(x,{size:12})]})}),e.jsx("th",{className:"col-points",onClick:()=>m("points"),children:e.jsxs("div",{className:"sortable-header",children:["ì‹ ë¢°ë„ P ",e.jsx(x,{size:12})]})}),e.jsx("th",{className:"col-noshow",onClick:()=>m("noShowCount"),children:e.jsxs("div",{className:"sortable-header",children:["ë…¸ì‡¼ ",e.jsx(x,{size:12})]})}),e.jsx("th",{className:"col-status",onClick:()=>m("isSuspended"),children:e.jsxs("div",{className:"sortable-header",children:["ìƒíƒœ ",e.jsx(x,{size:12})]})}),e.jsx("th",{className:"col-created",onClick:()=>m("createdAt"),children:e.jsxs("div",{className:"sortable-header",children:["ê°€ìž…ì¼ ",e.jsx(x,{size:12})]})}),e.jsx("th",{className:"col-actions cell-center",children:e.jsx("div",{className:"header-content-centered",children:"ê´€ë¦¬"})})]})}),e.jsx("tbody",{children:z.length>0?z.map(s=>{const a=s.loyaltyTier||"ê³µêµ¬ìƒˆì‹¹",n=_[a],t=s.role||"customer",h=ee[t];return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"tier-cell",style:{color:n.color},children:[n.icon," ",e.jsx("span",{children:a})]})}),e.jsxs("td",{title:`${s.displayName}${s.nickname?` (${s.nickname})`:""}`,children:[s.displayName||"ì´ë¦„ ì—†ìŒ",s.nickname?` (${s.nickname})`:""]}),e.jsx("td",{children:B(s.phone)}),e.jsx("td",{title:s.email||"",children:s.email}),e.jsx("td",{children:e.jsx("span",{className:`role-badge ${h.className}`,children:h.label})}),e.jsxs("td",{className:"cell-right",children:[(s.points||0).toLocaleString()," P"]}),e.jsx("td",{className:`cell-center ${s.noShowCount&&s.noShowCount>0?"text-danger":""}`,children:s.noShowCount||0}),e.jsx("td",{className:"cell-center",children:s.isSuspended?e.jsx("span",{className:"status-badge restricted",children:"ì´ìš© ì œí•œ"}):e.jsx("span",{className:"status-badge active",children:"ì •ìƒ"})}),e.jsx("td",{children:s.createdAt?.toDate().toLocaleDateString("ko-KR")}),e.jsx("td",{className:"cell-center",children:e.jsxs("div",{className:"action-cell-buttons",children:[e.jsx(V,{to:`/admin/users/${s.uid}`,className:"action-button-v2",children:"ìƒì„¸"}),e.jsxs("button",{onClick:()=>P(s),className:"action-button-v2 primary",children:[e.jsx(q,{size:14})," í¬ì¸íŠ¸"]})]})})]},s.uid)}):e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"no-results-cell",children:"í‘œì‹œí•  ê³ ê°ì´ ì—†ìŠµë‹ˆë‹¤."})})})]})}),e.jsx(se,{currentPage:S,totalPages:Math.ceil(C.length/p),onPageChange:w,itemsPerPage:p,onItemsPerPageChange:s=>A(Number(s.target.value)),totalItems:C.length})]})]})};export{ue as default};
