# κΈ°λ¥ λΉ„ν™μ„±ν™” μ‘μ—… μ™„λ£ λ³΄κ³ μ„

**μ‘μ„±μΌ**: 2025λ…„ 1μ›”  
**μ‘μ—… μƒνƒ**: λ€κΈ°μ λ…λ‹¨(waitlist) λ° ν¬μΈνΈ κΈ°λ¥ λΉ„ν™μ„±ν™” μ™„λ£

---

## π“‹ λΉ„ν™μ„±ν™” λ€μƒ κΈ°λ¥

### 1. λ€κΈ°μ λ…λ‹¨ (Waitlist) κΈ°λ¥
- **λ©μ **: ν’μ  μƒν’μ— λ€ν• λ€κΈ° μ‹ μ²­ κΈ°λ¥
- **λΉ„ν™μ„±ν™” μ΄μ **: μ‹¤μ΄μμ—μ„ μ‚¬μ©ν•μ§€ μ•μΌλ©°, νΌλ€μ„ μ•ΌκΈ°ν•  μ μμ

### 2. ν¬μΈνΈ/λ³΄μƒ/λ§μΌλ¦¬μ§€ κΈ°λ¥
- **λ©μ **: μ‚¬μ©μ ν™λ™μ— λ€ν• ν¬μΈνΈ μ λ¦½ λ° μ‚¬μ©
- **λΉ„ν™μ„±ν™” μ΄μ **: μ‹¤μ΄μμ—μ„ μ‚¬μ©ν•μ§€ μ•μΌλ©°, λ°μ΄ν„° κ΄€λ¦¬ λ¶€λ‹΄

---

## π“ λ³€κ²½λ νμΌ λ©λ΅

### λ€κΈ°μ λ…λ‹¨ (Waitlist) κ΄€λ ¨

#### 1. `functions/src/callable/waitlist.ts`
- **λ³€κ²½ λ‚΄μ©**: `addWaitlistEntry` ν•¨μ νΈμ¶ λ¶κ°€ μ²λ¦¬
- **μ΄μ **: Cloud Functionμ—μ„ λ€κΈ° μ‹ μ²­ API νΈμ¶ μ°¨λ‹¨
- **λ°©λ²•**: ν•¨μ μ‹μ‘ λ¶€λ¶„μ—μ„ `HttpsError` throwν•μ—¬ νΈμ¶ μ°¨λ‹¨

#### 2. `src/firebase/productService.ts`
- **λ³€κ²½ λ‚΄μ©**: 
  - `getUserWaitlist()` - λΉ λ°°μ—΄ λ°ν™
  - `getWaitlistForRound()` - λΉ λ°°μ—΄ λ°ν™
  - `cancelWaitlistEntry()` - μ΅°κΈ° return
- **μ΄μ **: ν΄λΌμ΄μ–ΈνΈμ—μ„ λ€κΈ°μ λ…λ‹¨ κ΄€λ ¨ ν•¨μ νΈμ¶ μ°¨λ‹¨
- **λ°©λ²•**: ν•¨μ μ‹μ‘ λ¶€λ¶„μ—μ„ κ²½κ³  λ΅κ·Έ μ¶λ ¥ ν›„ λΉ κ°’ λ°ν™

#### 3. `src/components/customer/ProductCard.tsx`
- **λ³€κ²½ λ‚΄μ©**: `handleAddToWaitlist` ν•¨μ μ£Όμ„ μ²λ¦¬
- **μ΄μ **: UIμ—μ„ λ€κΈ° μ‹ μ²­ λ²„νΌ ν΄λ¦­ μ‹ νΈμ¶λλ” ν•¨μ λΉ„ν™μ„±ν™”
- **λ°©λ²•**: ν•¨μ μ „μ²΄λ¥Ό μ£Όμ„ μ²λ¦¬ (μ΄λ―Έ UIμ—μ„ λ²„νΌμ΄ μ κ±°λμ–΄ μμ)

#### 4. `src/pages/admin/DashboardPage.tsx`
- **λ³€κ²½ λ‚΄μ©**: λ€κΈ° μλ‰ μ»¬λΌ μ£Όμ„ μ²λ¦¬ (μ΄λ―Έ μ™„λ£λ¨)
- **μ΄μ **: κ΄€λ¦¬μ λ€μ‹λ³΄λ“μ—μ„ λ€κΈ°μ μλ‰ ν‘μ‹ μ κ±°

#### 5. `src/pages/admin/UserDetailPage.tsx`
- **λ³€κ²½ λ‚΄μ©**: λ€κΈ° λ©λ΅ νƒ­ μ£Όμ„ μ²λ¦¬ (μ΄λ―Έ μ™„λ£λ¨)
- **μ΄μ **: μ‚¬μ©μ μƒμ„Έ νμ΄μ§€μ—μ„ λ€κΈ° λ©λ΅ νƒ­ μ κ±°

### ν¬μΈνΈ/λ³΄μƒ/λ§μΌλ¦¬μ§€ κ΄€λ ¨

#### 6. `src/firebase/pointService.ts`
- **λ³€κ²½ λ‚΄μ©**:
  - `claimMissionReward()` - μ—λ¬ throw
  - `adjustUserPoints()` - μ—λ¬ throw
  - `getPointHistory()` - λΉ λ°°μ—΄ λ°ν™
  - `recordDailyVisit()` - μ΅°κΈ° return
- **μ΄μ **: ν΄λΌμ΄μ–ΈνΈμ—μ„ ν¬μΈνΈ κ΄€λ ¨ ν•¨μ νΈμ¶ μ°¨λ‹¨
- **λ°©λ²•**: ν•¨μ μ‹μ‘ λ¶€λ¶„μ—μ„ κ²½κ³  λ΅κ·Έ μ¶λ ¥ ν›„ μ—λ¬/λΉ κ°’ λ°ν™

#### 7. `src/pages/customer/MyPage.tsx`
- **λ³€κ²½ λ‚΄μ©**: λ“±κΈ‰ λ°°μ§€ λ° ν¬μΈνΈ ν‘μ‹ μ κ±° (μ΄λ―Έ μ™„λ£λ¨)
- **μ΄μ **: κ³ κ° λ§μ΄νμ΄μ§€μ—μ„ ν¬μΈνΈ κ΄€λ ¨ UI μ κ±°

#### 8. `src/pages/admin/UserListPage.tsx`
- **λ³€κ²½ λ‚΄μ©**: λ“±κΈ‰/ν¬μΈνΈ μ»¬λΌ λ° ν¬μΈνΈ κ΄€λ¦¬ λ²„νΌ μ κ±° (μ΄λ―Έ μ™„λ£λ¨)
- **μ΄μ **: κ΄€λ¦¬μ μ‚¬μ©μ λ©λ΅μ—μ„ ν¬μΈνΈ κ΄€λ ¨ UI μ κ±°

#### 9. `src/pages/admin/UserDetailPage.tsx`
- **λ³€κ²½ λ‚΄μ©**: 
  - ν¬μΈνΈ ν™λ™ νƒ­ μ κ±° (μ΄λ―Έ μ™„λ£λ¨)
  - ν¬μΈνΈ κ΄€λ¦¬ λ²„νΌ μ κ±° (μ΄λ―Έ μ™„λ£λ¨)
  - μ‹ λΆ°λ„ ν¬μΈνΈ ν‘μ‹ μ κ±° (μ΄λ―Έ μ™„λ£λ¨)
  - μ‹ λΆ°λ„ κ΄€λ¦¬ μΉ΄λ“ μ κ±° (μ΄λ―Έ μ™„λ£λ¨)
- **μ΄μ **: κ΄€λ¦¬μ μ‚¬μ©μ μƒμ„Έ νμ΄μ§€μ—μ„ ν¬μΈνΈ κ΄€λ ¨ UI μ κ±°

---

## β… λΉ„ν™μ„±ν™” λ°©λ²•λ΅ 

### μ›μΉ™
1. **Firestore λ°μ΄ν„°λ” κ±΄λ“λ¦¬μ§€ μ•μ**: κΈ°μ΅΄ λ°μ΄ν„°λ” κ·Έλ€λ΅ μ μ§€
2. **UI μ§„μ…μ  μ κ±°**: λ²„νΌ, νƒ­, λ§ν¬ λ“± μ‚¬μ©μκ°€ μ ‘κ·Όν•  μ μλ” κ²½λ΅ μ°¨λ‹¨
3. **API/Service ν•¨μ νΈμ¶ λ¶κ°€ μ²λ¦¬**: ν•¨μ νΈμ¶ μ‹ μ—λ¬ λλ” λΉ κ°’ λ°ν™
4. **TODO μ£Όμ„μΌλ΅ ν‘μ‹**: λ‚μ¤‘μ— λ‹¤μ‹ ν™μ„±ν™”ν•  μ μλ„λ΅ μ£Όμ„μΌλ΅ ν‘μ‹

### κµ¬ν„ λ°©μ‹
- **Cloud Functions**: ν•¨μ μ‹μ‘ λ¶€λ¶„μ—μ„ `HttpsError` throw
- **ν΄λΌμ΄μ–ΈνΈ Service ν•¨μ**: κ²½κ³  λ΅κ·Έ μ¶λ ¥ ν›„ λΉ κ°’/μ—λ¬ λ°ν™
- **UI μ»΄ν¬λ„νΈ**: μ΄λ―Έ μ£Όμ„ μ²λ¦¬λμ–΄ μκ±°λ‚ μ κ±°λ¨

---

## π” ν™•μΈ μ‚¬ν•­

### λ€κΈ°μ λ…λ‹¨
- β… Cloud Function `addWaitlistEntry` νΈμ¶ μ°¨λ‹¨
- β… ν΄λΌμ΄μ–ΈνΈ ν•¨μ `getUserWaitlist`, `getWaitlistForRound`, `cancelWaitlistEntry` λΉ„ν™μ„±ν™”
- β… UIμ—μ„ λ€κΈ° μ‹ μ²­ λ²„νΌ μ κ±° (μ΄λ―Έ μ™„λ£)
- β… κ΄€λ¦¬μ νμ΄μ§€μ—μ„ λ€κΈ° μλ‰ ν‘μ‹ μ κ±° (μ΄λ―Έ μ™„λ£)

### ν¬μΈνΈ/λ³΄μƒ
- β… ν΄λΌμ΄μ–ΈνΈ ν•¨μ `claimMissionReward`, `adjustUserPoints`, `getPointHistory`, `recordDailyVisit` λΉ„ν™μ„±ν™”
- β… UIμ—μ„ ν¬μΈνΈ ν‘μ‹ μ κ±° (μ΄λ―Έ μ™„λ£)
- β… κ΄€λ¦¬μ νμ΄μ§€μ—μ„ ν¬μΈνΈ κ΄€λ¦¬ κΈ°λ¥ μ κ±° (μ΄λ―Έ μ™„λ£)
- β οΈ Cloud Functionsμ ν¬μΈνΈ κ΄€λ ¨ ν•¨μλ” λ³„λ„ ν™•μΈ ν•„μ”:
  - `functions/src/callable/points.ts` - μ΄λ―Έ μ£Όμ„ μ²λ¦¬λ¨
  - `functions/src/triggers/points.ts` - ν™•μΈ ν•„μ”
  - `functions/src/scheduled/points.ts` - ν™•μΈ ν•„μ”

---

## π“ λ‹¤μ λ‹¨κ³„

1. **κ΄€λ¦¬μ νμ΄μ§€ μ‹¤μ΄μ κΈ°μ¤€ μ κ²€** (μ§„ν–‰ μμ •)
2. **λ°±μ—”λ“(Cloud Functions) μ κ²€** (μ§„ν–‰ μμ •)
3. **ν¬μΈνΈ κ΄€λ ¨ Cloud Functions νΈλ¦¬κ±°/μ¤μΌ€μ¤„λ¬ λΉ„ν™μ„±ν™”** (ν•„μ” μ‹)

---

## β οΈ μ£Όμμ‚¬ν•­

- Firestoreμ— μ €μ¥λ κΈ°μ΅΄ λ€κΈ°μ λ…λ‹¨ λ° ν¬μΈνΈ λ°μ΄ν„°λ” κ·Έλ€λ΅ μ μ§€λ©λ‹λ‹¤.
- ν–¥ν›„ κΈ°λ¥μ„ λ‹¤μ‹ ν™μ„±ν™”ν•λ ¤λ©΄ μ΄ λ¬Έμ„λ¥Ό μ°Έκ³ ν•μ—¬ μ£Όμ„ μ²λ¦¬λ μ½”λ“λ¥Ό λ³µμ›ν•λ©΄ λ©λ‹λ‹¤.
- λ°±μ—”λ“ νΈλ¦¬κ±°/μ¤μΌ€μ¤„λ¬κ°€ ν¬μΈνΈ κ΄€λ ¨ μ‘μ—…μ„ μν–‰ν•λ” κ²½μ° λ³„λ„ λΉ„ν™μ„±ν™”κ°€ ν•„μ”ν•  μ μμµλ‹λ‹¤.

